{
  "project": "Hartwell Round Robin v4 Enhancements",
  "branchName": "ralph/v4-enhancements",
  "description": "Post-testing bug fixes, UX improvements, and missing features for the Hartwell Round Robin pickleball league management app.",
  "testingNotes": "All stories include automated tests using Vitest + React Testing Library. Run tests with: npm run test. Create test files alongside source files as *.test.ts or *.test.tsx.",
  "userStories": [
    {
      "id": "US-V4-001",
      "title": "Prevent Duplicate Season Names",
      "description": "As an admin, I want the system to prevent duplicate season names so I can easily distinguish between seasons.",
      "acceptanceCriteria": [
        "When creating a season, validate name is unique for this admin (case-insensitive)",
        "Check uses LOWER() comparison and trims whitespace",
        "Show inline error: 'A season with this name already exists'",
        "Form submission blocked until name is unique",
        "Validation occurs on blur and on submit",
        "Add validation to src/lib/seasons/validation.ts",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/lib/seasons/validation.test.ts",
        "Test: validateSeasonName('Test Season') returns valid when no duplicate exists",
        "Test: validateSeasonName('Test Season') returns error when duplicate exists (case-insensitive)",
        "Test: validateSeasonName('  Test Season  ') trims whitespace before comparison",
        "Run: npm run test -- validation.test.ts (all tests pass)"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Mock Supabase client in tests to simulate existing seasons."
    },
    {
      "id": "US-V4-002",
      "title": "Prevent Duplicate Player Names",
      "description": "As an admin, I want the system to prevent duplicate player names so roster data remains clean.",
      "acceptanceCriteria": [
        "When adding a player, validate name is unique within admin's player pool (case-insensitive)",
        "Trim whitespace and collapse multiple spaces before comparison",
        "Show inline error: 'A player with this name already exists'",
        "Suggest adding existing player to season instead if they exist",
        "Form submission blocked until resolved",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/lib/players/validation.test.ts",
        "Test: validatePlayerName('John Doe') returns valid when no duplicate exists",
        "Test: validatePlayerName('john doe') returns error when 'John Doe' exists (case-insensitive)",
        "Test: validatePlayerName('John  Doe') collapses multiple spaces and detects duplicate 'John Doe'",
        "Run: npm run test -- validation.test.ts (all tests pass)"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Mock Supabase client in tests. Create src/lib/players/ directory if needed."
    },
    {
      "id": "US-V4-016",
      "title": "Toast Notification Infrastructure",
      "description": "As an admin, I want confirmation messages when actions complete so I know my changes were saved.",
      "acceptanceCriteria": [
        "Sonner is already installed - import { toast } from 'sonner'",
        "Add Toaster component to root layout (src/app/layout.tsx) if not present",
        "Configure position: bottom-right",
        "Configure auto-dismiss after 4 seconds",
        "Add toast.success() for: Season created, Player added to roster",
        "Add toast.error() for: Failed saves, validation errors",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/app/layout.test.tsx",
        "Test: RootLayout renders Toaster component",
        "Test: Toaster is configured with position='bottom-right'",
        "Run: npm run test -- layout.test.tsx (all tests pass)"
      ],
      "priority": 3,
      "passes": true,
      "notes": "IMPORTANT: This story MUST be completed before stories that use toast. Sonner v2.0.7 already in package.json."
    },
    {
      "id": "US-V4-003",
      "title": "Add Confirmation Dialog for Player Removal",
      "description": "As an admin, I want a confirmation before removing a player so I don't accidentally remove someone.",
      "acceptanceCriteria": [
        "Clicking 'Remove' shows confirmation dialog using existing Dialog component",
        "Dialog shows: 'Remove [Player Name] from this season's roster?'",
        "Dialog has Cancel and Remove buttons",
        "Cancel closes dialog with no action",
        "Remove executes the removal and closes dialog",
        "Use toast.success() to confirm removal: '[Player Name] removed from roster'",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create or update test file for roster component",
        "Test: clicking Remove button opens confirmation dialog",
        "Test: dialog displays correct player name",
        "Test: clicking Cancel closes dialog without calling remove API",
        "Test: clicking Remove calls remove API and closes dialog",
        "Run: npm run test -- roster (all tests pass)"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Depends on US-V4-016 (toast infrastructure). Use existing Dialog component from src/components/ui/dialog.tsx. Use @testing-library/react for component tests."
    },
    {
      "id": "US-V4-004",
      "title": "Disable Schedule Generation Below Minimum",
      "description": "As an admin, I want the Generate Schedule button disabled when player count is invalid so I can't accidentally generate an invalid schedule.",
      "acceptanceCriteria": [
        "Button disabled when available players < 24",
        "Button disabled when available players > 32",
        "Use Tooltip component to show: 'Need 24-32 available players (currently X)'",
        "Button visual state clearly indicates disabled (grayed out, cursor not-allowed)",
        "Warning message remains visible above button",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create or update test file for schedule generation component",
        "Test: Generate Schedule button is disabled when availablePlayers = 20",
        "Test: Generate Schedule button is disabled when availablePlayers = 35",
        "Test: Generate Schedule button is enabled when availablePlayers = 28",
        "Test: disabled button has correct tooltip text with current player count",
        "Run: npm run test -- schedule (all tests pass)"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Use existing Tooltip component from src/components/ui/tooltip.tsx"
    },
    {
      "id": "US-V4-005",
      "title": "Fix Week Tab Highlighting",
      "description": "As an admin, I want the correct week tab highlighted so I always know which week I'm viewing.",
      "acceptanceCriteria": [
        "Review week-navigation.tsx for tab highlighting logic",
        "Active/selected week tab has distinct visual highlight (blue border/background)",
        "Highlight updates immediately when clicking different week",
        "'(Active Week)' label only appears on the season's actual active week (earliest non-completed week)",
        "Works correctly with URL-based navigation (direct links to weeks)",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/app/dashboard/seasons/[id]/week-navigation.test.tsx",
        "Test: selected week tab has 'active' styling class",
        "Test: clicking different week updates selected state",
        "Test: '(Active Week)' label appears only on earliest non-completed week",
        "Test: component reads selectedWeek from URL params correctly",
        "Run: npm run test -- week-navigation.test.tsx (all tests pass)"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Bug is in src/app/dashboard/seasons/[id]/week-navigation.tsx. Mock useSearchParams and useRouter for testing."
    },
    {
      "id": "US-V4-006",
      "title": "Fix Timezone Date Display Issue",
      "description": "As an admin, I want the start date to display exactly as I entered it so schedule dates are accurate.",
      "acceptanceCriteria": [
        "Investigate date handling in season creation and display",
        "Date displays match date entered in form (no off-by-one)",
        "Store dates as date strings without time component where possible",
        "All week dates calculated correctly from start date",
        "PDF exports show correct dates",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/lib/dates/dateUtils.test.ts",
        "Test: formatDate('2026-01-15') displays 'January 15, 2026' regardless of timezone",
        "Test: parseFormDate('2026-01-15') returns correct date without timezone shift",
        "Test: calculateWeekDates(startDate, numWeeks) returns correct dates for each week",
        "Test: dates work correctly in UTC-5, UTC+0, and UTC+9 timezones (mock timezone)",
        "Run: npm run test -- dateUtils.test.ts (all tests pass)"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Create src/lib/dates/ directory with utility functions. Use date-fns if helpful. Store dates as YYYY-MM-DD strings."
    },
    {
      "id": "US-V4-007",
      "title": "Season Page Navigation - Routes Setup",
      "description": "As a developer, I want to restructure season routes to support section-based navigation.",
      "acceptanceCriteria": [
        "Create route: /dashboard/seasons/[id]/roster/page.tsx",
        "Create route: /dashboard/seasons/[id]/schedule/page.tsx (with week selector)",
        "Create route: /dashboard/seasons/[id]/leaderboard/page.tsx",
        "Extract roster management code from [id]/page.tsx to roster/page.tsx",
        "Extract leaderboard code from [id]/page.tsx to leaderboard/page.tsx",
        "Extract schedule/week management to schedule/page.tsx",
        "Update [id]/page.tsx to redirect to /schedule by default",
        "Each page fetches its own data (server component pattern)",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Test: roster/page.tsx file exists and exports default function",
        "Test: schedule/page.tsx file exists and exports default function",
        "Test: leaderboard/page.tsx file exists and exports default function",
        "Run: npm run build (build succeeds with new routes)"
      ],
      "priority": 8,
      "passes": true,
      "notes": "This sets up the route structure. Navigation component comes in next story (US-V4-008). Keep components modular so they can be imported into new pages."
    },
    {
      "id": "US-V4-008",
      "title": "Season Page Navigation - Mobile Nav Component",
      "description": "As an admin on mobile, I want clear navigation between season sections so I can quickly access what I need.",
      "acceptanceCriteria": [
        "Create SeasonNav component in src/app/dashboard/seasons/[id]/components/",
        "Links to: Roster (/roster), Schedule (/schedule), Leaderboard (/leaderboard)",
        "On mobile (< 768px): Fixed bottom navigation bar with icons",
        "On desktop (>= 768px): Horizontal tabs below season header",
        "Use lucide-react icons: Users (roster), Calendar (schedule), Trophy (leaderboard)",
        "Current section clearly indicated (active state styling)",
        "Touch targets minimum 44px on mobile",
        "Navigation is sticky (doesn't scroll away)",
        "Include SeasonNav in a shared layout or each page",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/app/dashboard/seasons/[id]/components/SeasonNav.test.tsx",
        "Test: SeasonNav renders three navigation links",
        "Test: active route has 'active' styling applied",
        "Test: links navigate to correct paths (roster, schedule, leaderboard)",
        "Test: mobile styles apply at viewport < 768px (use matchMedia mock)",
        "Run: npm run test -- SeasonNav.test.tsx (all tests pass)"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Depends on US-V4-007 (routes). Use Tailwind responsive classes (md:hidden, hidden md:flex) for mobile/desktop switching."
    },
    {
      "id": "US-V4-009",
      "title": "Score Entry Filters (Round and Court)",
      "description": "As a scorekeeper, I want to filter score entry by round or court so I can focus on specific games.",
      "acceptanceCriteria": [
        "Add filter UI above score entry list in the score entry component",
        "Filter type toggle with two options: 'By Round' | 'By Court'",
        "When 'By Round' selected: show dropdown with Round 1, Round 2, etc.",
        "When 'By Court' selected: show dropdown with Court 1, Court 2, etc.",
        "Only games matching selected filter displayed",
        "Games sorted by round number when filtering by court",
        "Default on page load: 'By Round' with Round 1 selected",
        "Show summary: 'Showing X games | Y of X completed'",
        "Switching between Round/Court resets to first option (Round 1 or Court 1)",
        "Filter selection persists in URL params or component state during session",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create or update test file for score entry component",
        "Test: filterGamesByRound(games, 2) returns only round 2 games",
        "Test: filterGamesByCourt(games, 3) returns only court 3 games, sorted by round",
        "Test: filter UI defaults to 'By Round' with Round 1",
        "Test: changing filter type resets dropdown to first option",
        "Test: summary text shows correct counts (filtered games / completed)",
        "Run: npm run test -- score-entry (all tests pass)"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Use existing Select component from src/components/ui/select.tsx. Extract filter logic to pure functions for easy testing."
    },
    {
      "id": "US-V4-010",
      "title": "Collapsible Roster View",
      "description": "As an admin, I want the roster to be collapsible so I can reduce visual clutter.",
      "acceptanceCriteria": [
        "Roster section header has expand/collapse toggle button",
        "Use ChevronDown/ChevronRight icons from lucide-react",
        "Collapsed state shows: '[X] players in roster' with expand button",
        "Expanded state shows full player list with add/remove functionality",
        "Collapse state stored in localStorage key 'roster-collapsed' for persistence",
        "Smooth animation on expand/collapse using Tailwind transitions",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create or update test file for roster component",
        "Test: roster starts expanded by default (no localStorage value)",
        "Test: clicking toggle button collapses roster and hides player list",
        "Test: collapsed state shows player count summary",
        "Test: collapse state is saved to localStorage on toggle",
        "Test: component reads initial state from localStorage on mount",
        "Run: npm run test -- roster (all tests pass)"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Mock localStorage in tests using vi.spyOn(Storage.prototype, 'getItem')"
    },
    {
      "id": "US-V4-011",
      "title": "Manual Player Swap - Selection Mode",
      "description": "As an admin, I want to click on a player to start a swap so I can rearrange the schedule.",
      "acceptanceCriteria": [
        "On draft schedule (not finalized), player names are clickable (cursor: pointer)",
        "Clicking a player enters 'swap mode' - store selected player in component state",
        "Selected player has blue border/highlight (ring-2 ring-blue-500)",
        "Banner appears at top: 'Select another player to swap with [Name]' with Cancel button",
        "Valid swap targets get light green background (bg-green-100)",
        "Valid targets: any player in SAME round (other courts or bye list)",
        "Players in other rounds are dimmed (opacity-50) and not clickable",
        "Cancel button exits swap mode, removes all highlights",
        "Escape key also cancels swap mode (useEffect with keydown listener)",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file for schedule swap functionality",
        "Test: clicking player on draft schedule enters swap mode",
        "Test: selected player has correct highlight classes",
        "Test: swap banner displays with correct player name",
        "Test: getValidSwapTargets(selectedPlayer, schedule) returns players in same round only",
        "Test: clicking Cancel exits swap mode and clears selection",
        "Test: pressing Escape key exits swap mode",
        "Run: npm run test -- swap (all tests pass)"
      ],
      "priority": 12,
      "passes": true,
      "notes": "This is UI/state only. Actual swap execution in US-V4-012. Only works on draft schedules, not finalized ones."
    },
    {
      "id": "US-V4-012",
      "title": "Manual Player Swap - Execute Swap",
      "description": "As an admin, I want to complete a player swap by clicking the second player.",
      "acceptanceCriteria": [
        "DEPENDS ON US-V4-011 being complete",
        "In swap mode, clicking a valid target (green highlighted) executes the swap",
        "Both players' positions update immediately in UI (local state)",
        "Swap mode exits automatically after successful swap",
        "Show toast.success(): 'Swapped [Player A] with [Player B]'",
        "Schedule marked as having unsaved changes (show 'Unsaved changes' indicator)",
        "Save button appears or becomes prominent when changes exist",
        "Save button persists swaps to database",
        "If user clicks Regenerate while unsaved changes exist, show confirm dialog: 'Unsaved changes will be lost. Continue?'",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Test: executeSwap(playerA, playerB, schedule) returns updated schedule with positions swapped",
        "Test: clicking valid target calls executeSwap and updates local state",
        "Test: swap mode exits after successful swap",
        "Test: 'Unsaved changes' indicator appears after swap",
        "Test: Save button calls API to persist schedule changes",
        "Run: npm run test -- swap (all tests pass)"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Depends on US-V4-011 (selection mode) and US-V4-016 (toast). Swap modifies local state until Save is clicked."
    },
    {
      "id": "US-V4-013",
      "title": "PDF Export - Court Score Sheets",
      "description": "As an admin, I want to print score sheets for each court so teams can write their scores.",
      "acceptanceCriteria": [
        "Add 'Export Score Sheets' button on finalized schedule (next to existing Export PDF button)",
        "Button uses secondary/outline variant styling",
        "Generates PDF using jsPDF (already installed)",
        "PDF orientation: landscape, format: letter (8.5x11)",
        "One page per round",
        "Each page header: Season name, Week X, Date, 'Round X'",
        "Each page shows all courts in a 2-column or 3-column grid",
        "Each court box contains: Court number (large, bold), Team 1 player names, Team 2 player names, empty score boxes (at least 0.75 inch squares)",
        "Footer: 'Page X of Y'",
        "File downloads as: [SeasonName]-Week[X]-ScoreSheets.pdf",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/lib/pdf/exportScoreSheetsPdf.test.ts",
        "Test: exportScoreSheetsPdf returns jsPDF instance",
        "Test: PDF has correct number of pages (one per round)",
        "Test: generateCourtBox returns correct layout data for court",
        "Test: header includes season name, week number, and date",
        "Run: npm run test -- exportScoreSheetsPdf.test.ts (all tests pass)"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Reference existing PDF code in src/lib/pdf/exportSchedulePdf.ts for patterns. Create new file: src/lib/pdf/exportScoreSheetsPdf.ts"
    },
    {
      "id": "US-V4-014",
      "title": "Bulk Player Import",
      "description": "As an admin, I want to import multiple players at once so roster setup is faster.",
      "acceptanceCriteria": [
        "Add 'Bulk Import' button on roster page (secondary/outline button style)",
        "Opens Dialog with: title 'Bulk Import Players', textarea, action buttons",
        "Textarea placeholder: 'Paste player names, one per line or comma-separated'",
        "Parse input: split on newlines and commas, trim whitespace from each name, filter empty",
        "Show preview below textarea: list of names to be added with total count",
        "Duplicate detection: compare against existing players (case-insensitive), show which names already exist",
        "If duplicates found, show warning and options: 'Skip duplicates and import new players' or 'Cancel'",
        "On import: create new players in players table, add all (new and existing) to season_players",
        "Show toast.success(): 'Added X players. Y duplicates skipped.'",
        "Close dialog on success",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/lib/players/bulkImport.test.ts",
        "Test: parsePlayerNames('Alice\\nBob, Carol') returns ['Alice', 'Bob', 'Carol']",
        "Test: parsePlayerNames('  Alice  ,  Bob  ') trims whitespace correctly",
        "Test: parsePlayerNames('Alice\\n\\nBob') filters empty entries",
        "Test: findDuplicates(names, existingPlayers) returns correct duplicate list",
        "Test: component shows preview with correct count after parsing",
        "Run: npm run test -- bulkImport.test.ts (all tests pass)"
      ],
      "priority": 15,
      "passes": true,
      "notes": "Depends on US-V4-016 (toast). Extract parsing logic to pure functions in src/lib/players/bulkImport.ts for testing."
    },
    {
      "id": "US-V4-015",
      "title": "Password Requirements Display",
      "description": "As a new user, I want to see password requirements so I can create a valid password on first try.",
      "acceptanceCriteria": [
        "On registration page (src/app/register/page.tsx), add requirements section below password field",
        "Requirements based on Supabase defaults: minimum 6 characters",
        "Display as checklist with visual indicators",
        "Use Check icon (green) for met requirements, Circle icon (gray) for unmet",
        "Real-time validation as user types (controlled input with onChange)",
        "Optional: add simple strength indicator text (Weak < 8 chars, Medium 8-12, Strong 12+)",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/app/register/PasswordRequirements.test.tsx",
        "Test: validatePasswordRequirements('12345') returns { minLength: false }",
        "Test: validatePasswordRequirements('123456') returns { minLength: true }",
        "Test: component shows gray circle when requirement not met",
        "Test: component shows green check when requirement met",
        "Test: getPasswordStrength returns 'weak' for < 8 chars, 'medium' for 8-12, 'strong' for 12+",
        "Run: npm run test -- PasswordRequirements.test.tsx (all tests pass)"
      ],
      "priority": 16,
      "passes": true,
      "notes": "Extract validation logic to pure functions for easy testing. Create PasswordRequirements component."
    },
    {
      "id": "US-V4-016",
      "title": "Forgot Password Flow",
      "description": "As a user who forgot my password, I want to reset it via email so I can regain access.",
      "acceptanceCriteria": [
        "Add 'Forgot password?' link on login page (below password field or submit button)",
        "Link navigates to /forgot-password (create new page)",
        "Forgot password page has: heading, email input, Submit button, link back to login",
        "On submit, call supabase.auth.resetPasswordForEmail(email, { redirectTo })",
        "redirectTo should point to /reset-password",
        "Show success message: 'Check your email for a password reset link'",
        "Handle errors gracefully (don't reveal if email exists for security)",
        "Create /reset-password page for the reset link destination",
        "Reset page: new password field, confirm password field, Submit button",
        "Validate passwords match before submit",
        "On submit, call supabase.auth.updateUser({ password })",
        "On success, redirect to /login with success message (use query param: ?reset=success)",
        "Login page shows 'Password reset successfully' if reset=success in URL",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/app/forgot-password/page.test.tsx",
        "Test: forgot-password page renders email input and submit button",
        "Test: submitting email calls supabase.auth.resetPasswordForEmail",
        "Test: success message displays after successful submission",
        "Create test file: src/app/reset-password/page.test.tsx",
        "Test: reset-password page renders password and confirm fields",
        "Test: form shows error when passwords don't match",
        "Test: submitting matching passwords calls supabase.auth.updateUser",
        "Run: npm run test -- forgot-password reset-password (all tests pass)"
      ],
      "priority": 17,
      "passes": true,
      "notes": "Mock Supabase auth methods in tests. Email sending requires Supabase dashboard configuration."
    },
    {
      "id": "US-V4-017",
      "title": "Player Search in Roster",
      "description": "As an admin with a large roster, I want to search for players by name.",
      "acceptanceCriteria": [
        "Add search input above player list on roster page",
        "Use Input component with Search icon (lucide-react)",
        "Placeholder: 'Search players...'",
        "Filters player list in real-time as typing (client-side filter with useState)",
        "Case-insensitive matching using toLowerCase().includes()",
        "Clear button (X icon) appears when input has text, resets filter on click",
        "'No players found' message if no matches",
        "Search also works on 'Add Existing Player' dropdown/list if present",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create or update roster test file",
        "Test: filterPlayers(players, 'john') returns players with 'john' in name (case-insensitive)",
        "Test: filterPlayers(players, 'JOHN') returns same results as 'john'",
        "Test: filterPlayers(players, 'xyz') returns empty array when no match",
        "Test: clear button resets search input and shows all players",
        "Test: 'No players found' message displays when filter returns empty",
        "Run: npm run test -- roster (all tests pass)"
      ],
      "priority": 18,
      "passes": false,
      "notes": "Extract filterPlayers to a pure function for easy testing."
    },
    {
      "id": "US-V4-018",
      "title": "Score Entry Progress Indicator",
      "description": "As a scorekeeper, I want to see score entry progress so I know how many games remain.",
      "acceptanceCriteria": [
        "Add progress section at top of score entry area",
        "Text shows: 'X of Y games completed (Z%)'",
        "Visual progress bar below text",
        "Progress bar uses green color (bg-green-500)",
        "Bar width calculated as percentage: (completed / total) * 100",
        "Updates automatically when scores are saved (reactive to game state)",
        "When 100% complete, show CheckCircle icon next to text",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create test file: src/lib/games/progress.test.ts",
        "Test: calculateProgress(games) returns { completed: 5, total: 10, percentage: 50 }",
        "Test: calculateProgress returns percentage: 100 when all games have scores",
        "Test: calculateProgress returns percentage: 0 when no games have scores",
        "Test: isGameComplete(game) returns true only when both scores are entered",
        "Test: progress component shows CheckCircle when percentage is 100",
        "Run: npm run test -- progress.test.ts (all tests pass)"
      ],
      "priority": 19,
      "passes": false,
      "notes": "Extract calculateProgress to src/lib/games/progress.ts for testing."
    },
    {
      "id": "US-V4-019",
      "title": "Loading Indicators for Async Operations",
      "description": "As a user, I want loading indicators during async operations so I know the app is working.",
      "acceptanceCriteria": [
        "Add loading state to: Generate Schedule button, Save Score buttons, Finalize button, PDF export buttons",
        "Pattern: const [isLoading, setIsLoading] = useState(false)",
        "Wrap async operations with setIsLoading(true) at start, setIsLoading(false) in finally block",
        "Button shows Loader2 icon (lucide-react) with animate-spin class during loading",
        "Button text changes to action-specific: 'Generating...', 'Saving...', 'Exporting...'",
        "Button disabled during loading (prevents double-clicks)",
        "Loading state clears on both success and error",
        "TypeScript compiles without errors",
        "ESLint passes without warnings",
        "Create or update component tests",
        "Test: Generate Schedule button shows spinner and 'Generating...' when loading",
        "Test: button is disabled during loading state",
        "Test: loading state clears after async operation completes",
        "Test: loading state clears even if async operation throws error",
        "Test: double-clicking disabled button does not trigger multiple API calls",
        "Run: npm run test (all loading-related tests pass)"
      ],
      "priority": 20,
      "passes": false,
      "notes": "Use try/finally pattern to ensure loading state always clears. Mock async functions to test loading behavior."
    }
  ]
}
